"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[375],{40890:function(ae,L,n){n.r(L);var K=n(15009),j=n.n(K),x=n(99289),m=n.n(x),F=n(97857),p=n.n(F),$=n(5574),h=n.n($),E=n(68717),z=n(35312),P=n(2453),W=n(2487),A=n(4393),V=n(7134),O=n(29905),G=n(14726),U=n(33076),H=n(9276),f=n(67294),t=n(85893),R=function(){var C={current:1,pageSize:4,sortField:"created_time",sortOrder:"desc"},Q=(0,f.useState)(p()({},C)),v=h()(Q,2),S=v[0],D=v[1],Z=(0,f.useState)(),M=h()(Z,2),X=M[0],I=M[1],a=(0,f.useState)(0),r=h()(a,2),s=r[0],o=r[1],e=(0,f.useState)(!0),l=h()(e,2),w=l[0],d=l[1],g=(0,z.useModel)("@@initialState"),i=g.initialState,te=i!=null?i:{},Y=te.currentUser,k=function(){var B=m()(j()().mark(function u(){var c,b,y,T;return j()().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return d(!0),_.prev=1,_.next=4,(0,E.MW)(S);case 4:c=_.sent,c.data?(I((b=c.data.records)!==null&&b!==void 0?b:[]),o((y=c.data.total)!==null&&y!==void 0?y:0),c.data.records&&c.data.records.forEach(function(N){if(N.status==="succeed"){var J,re=JSON.parse((J=N.genChart)!==null&&J!==void 0?J:"{}");re.title=void 0,N.genChart=JSON.stringify(re)}})):P.ZP.error((T=c.message)!==null&&T!==void 0?T:"\u83B7\u53D6\u6211\u7684\u56FE\u8868\u5931\u8D25"),_.next=11;break;case 8:_.prev=8,_.t0=_.catch(1),P.ZP.error("\u83B7\u53D6\u6211\u7684\u56FE\u8868\u5931\u8D25\uFF0C"+_.t0.message);case 11:d(!1);case 12:case"end":return _.stop()}},u,null,[[1,8]])}));return function(){return B.apply(this,arguments)}}(),se=(0,f.useState)(!1),q=h()(se,2),_e=q[0],ee=q[1],ue=function(){var B=m()(j()().mark(function u(c){var b,y,T;return j()().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:if(!_e){_.next=2;break}return _.abrupt("return");case 2:return ee(!0),b={chartId:c},_.prev=4,_.next=7,(0,E.F9)(b);case 7:if(y=_.sent,y!=null&&y.data){_.next=12;break}P.ZP.error((T=y.message)!==null&&T!==void 0?T:"\u5206\u6790\u5931\u8D25"),_.next=15;break;case 12:return P.ZP.success("\u5206\u6790\u4EFB\u52A1\u63D0\u4EA4\u6210\u529F\uFF0C\u7A0D\u540E\u8BF7\u5728\u6211\u7684\u56FE\u8868\u9875\u9762\u67E5\u770B"),_.next=15,k();case 15:_.next=20;break;case 17:_.prev=17,_.t0=_.catch(4),P.ZP.error("\u5206\u6790\u5931\u8D25,"+_.t0.message);case 20:ee(!1);case 21:case"end":return _.stop()}},u,null,[[4,17]])}));return function(c){return B.apply(this,arguments)}}();return(0,f.useEffect)(function(){k()},[S]),(0,t.jsxs)("div",{className:"my-chart-page",children:[(0,t.jsx)("div",{children:(0,t.jsx)(U.Z,{placeholder:"\u8BF7\u8F93\u5165\u56FE\u8868\u540D\u79F0",enterButton:!0,loading:w,onSearch:function(u){D(p()(p()({},C),{},{chartName:u}))}})}),(0,t.jsx)("div",{className:"margin-16"}),(0,t.jsx)(W.Z,{grid:{gutter:16,xs:1,sm:1,md:1,lg:2,xl:2,xxl:2},pagination:{onChange:function(u,c){D(p()(p()({},S),{},{current:u,pageSize:c}))},current:S.current,pageSize:S.pageSize,total:s},loading:w,dataSource:X,renderItem:function(u){var c;return(0,t.jsx)(W.Z.Item,{children:(0,t.jsxs)(A.Z,{style:{width:"100%"},children:[(0,t.jsx)(W.Z.Item.Meta,{avatar:(0,t.jsx)(V.C,{src:Y&&Y.userAvatar}),title:u.chartName,description:u.chartType?"\u56FE\u8868\u7C7B\u578B\uFF1A"+u.chartType:void 0}),(0,t.jsxs)(t.Fragment,{children:[u.status==="wait"&&(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(O.ZP,{status:"warning",title:"\u5F85\u751F\u6210",subTitle:(c=u.execMessage)!==null&&c!==void 0?c:"\u5F53\u524D\u56FE\u8868\u751F\u6210\u961F\u5217\u7E41\u5FD9\uFF0C\u8BF7\u8010\u5FC3\u7B49\u5019"})}),u.status==="running"&&(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(O.ZP,{status:"info",title:"\u56FE\u8868\u751F\u6210\u4E2D",subTitle:u.execMessage})}),u.status==="succeed"&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{style:{marginBottom:16}}),(0,t.jsx)("p",{children:"\u5206\u6790\u76EE\u6807\uFF1A"+u.goal}),(0,t.jsx)("div",{style:{marginBottom:16}}),(0,t.jsx)(H.Z,{option:u.genChart&&JSON.parse(u.genChart)}),(0,t.jsx)("div",{style:{marginBottom:16}}),(0,t.jsx)("p",{children:"\u5206\u6790\u7ED3\u8BBA\uFF1A"+u.genResult})]}),u.status==="failed"&&(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(O.ZP,{status:"error",title:"\u56FE\u8868\u751F\u6210\u5931\u8D25",subTitle:u.execMessage,extra:[(0,t.jsx)(G.ZP,{type:"primary",onClick:function(){return ue(u.id)},children:"\u91CD\u65B0\u751F\u6210"},u.id)]})})]})]})},u.id)}})]})};L.default=R},68717:function(ae,L,n){n.d(L,{F9:function(){return Z},MW:function(){return S},PI:function(){return t},VG:function(){return G}});var K=n(52677),j=n.n(K),x=n(15009),m=n.n(x),F=n(97857),p=n.n(F),$=n(99289),h=n.n($),E=n(35312);function z(a,r){return P.apply(this,arguments)}function P(){return P=_asyncToGenerator(_regeneratorRuntime().mark(function a(r,s){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",request("/api/chart/add",_objectSpread({method:"POST",headers:{"Content-Type":"application/json"},data:r},s||{})));case 1:case"end":return e.stop()}},a)})),P.apply(this,arguments)}function W(a,r){return A.apply(this,arguments)}function A(){return A=_asyncToGenerator(_regeneratorRuntime().mark(function a(r,s){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",request("/api/chart/delete",_objectSpread({method:"POST",headers:{"Content-Type":"application/json"},data:r},s||{})));case 1:case"end":return e.stop()}},a)})),A.apply(this,arguments)}function V(a,r){return O.apply(this,arguments)}function O(){return O=_asyncToGenerator(_regeneratorRuntime().mark(function a(r,s){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",request("/api/chart/edit",_objectSpread({method:"POST",headers:{"Content-Type":"application/json"},data:r},s||{})));case 1:case"end":return e.stop()}},a)})),O.apply(this,arguments)}function G(a,r,s,o){return U.apply(this,arguments)}function U(){return U=h()(m()().mark(function a(r,s,o,e){var l;return m()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return l=new FormData,o&&l.append("file",o),Object.keys(s).forEach(function(g){var i=s[g];i!=null&&l.append(g,j()(i)==="object"&&!(i instanceof File)?JSON.stringify(i):i)}),d.abrupt("return",(0,E.request)("/api/chart/gen",p()({method:"POST",params:p()({},r),data:l,requestType:"form"},e||{})));case 4:case"end":return d.stop()}},a)})),U.apply(this,arguments)}function H(a,r,s,o){return f.apply(this,arguments)}function f(){return f=_asyncToGenerator(_regeneratorRuntime().mark(function a(r,s,o,e){var l;return _regeneratorRuntime().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return l=new FormData,o&&l.append("file",o),Object.keys(s).forEach(function(g){var i=s[g];i!=null&&l.append(g,_typeof(i)==="object"&&!(i instanceof File)?JSON.stringify(i):i)}),d.abrupt("return",request("/api/chart/gen/async",_objectSpread({method:"POST",params:_objectSpread({},r),data:l,requestType:"form"},e||{})));case 4:case"end":return d.stop()}},a)})),f.apply(this,arguments)}function t(a,r,s,o){return R.apply(this,arguments)}function R(){return R=h()(m()().mark(function a(r,s,o,e){var l;return m()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return l=new FormData,o&&l.append("file",o),Object.keys(s).forEach(function(g){var i=s[g];i!=null&&l.append(g,j()(i)==="object"&&!(i instanceof File)?JSON.stringify(i):i)}),d.abrupt("return",(0,E.request)("/api/chart/gen/async/mq",p()({method:"POST",params:p()({},r),data:l,requestType:"form"},e||{})));case 4:case"end":return d.stop()}},a)})),R.apply(this,arguments)}function ne(a,r){return C.apply(this,arguments)}function C(){return C=_asyncToGenerator(_regeneratorRuntime().mark(function a(r,s){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",request("/api/chart/get",_objectSpread({method:"GET",params:_objectSpread({},r)},s||{})));case 1:case"end":return e.stop()}},a)})),C.apply(this,arguments)}function Q(a,r){return v.apply(this,arguments)}function v(){return v=_asyncToGenerator(_regeneratorRuntime().mark(function a(r,s){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",request("/api/chart/list/page",_objectSpread({method:"POST",headers:{"Content-Type":"application/json"},data:r},s||{})));case 1:case"end":return e.stop()}},a)})),v.apply(this,arguments)}function S(a,r){return D.apply(this,arguments)}function D(){return D=h()(m()().mark(function a(r,s){return m()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,E.request)("/api/chart/my/list/page",p()({method:"POST",headers:{"Content-Type":"application/json"},data:r},s||{})));case 1:case"end":return e.stop()}},a)})),D.apply(this,arguments)}function Z(a,r){return M.apply(this,arguments)}function M(){return M=h()(m()().mark(function a(r,s){return m()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,E.request)("/api/chart/regen",p()({method:"POST",params:p()({},r)},s||{})));case 1:case"end":return e.stop()}},a)})),M.apply(this,arguments)}function X(a,r){return I.apply(this,arguments)}function I(){return I=_asyncToGenerator(_regeneratorRuntime().mark(function a(r,s){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",request("/api/chart/update",_objectSpread({method:"POST",headers:{"Content-Type":"application/json"},data:r},s||{})));case 1:case"end":return e.stop()}},a)})),I.apply(this,arguments)}}}]);
